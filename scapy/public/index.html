<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/public/style.css">
  <meta http-equiv="Cache-Control" content="no-store" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <script defer src="/public/script.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; }
  </style>
  <script>
    window.__CONFIG__ = { apiBase: '' };
  </script>
  <link rel="icon" href="data:,">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; connect-src 'self';">
</head>
<body>
  <main class="container">
    <section class="controls">
      <div class="field">
        <label for="iface" data-tip="Сетевой интерфейс для захвата, например Ethernet или Wi‑Fi">Интерфейс</label>
        <input id="iface" type="text" placeholder="например, Ethernet" />
      </div>
      <div class="field">
        <label for="filter" data-tip="Фильтр захвата (BPF). Примеры: arp | tcp | tcp port 80 | host 1.2.3.4">Фильтр BPF</label>
        <input id="filter" type="text" placeholder="например, tcp port 80" />
      </div>
      <div class="buttons">
        <button id="start" data-tip="Запустить захват на выбранном интерфейсе и с фильтром">Старт</button>
        <button id="stop" disabled data-tip="Остановить захват (можно запустить снова)">Стоп</button>
        <button id="clear" data-tip="Очистить таблицу (захват не останавливается)">Очистить</button>
      </div>
      <div id="status" class="status" data-tip="Текущее состояние сниффера и ошибки">Ожидание</div>
    </section>

    <section class="log">
      <table>
        <thead>
          <tr>
            <th data-tip="Время захвата на этом компьютере">Время</th>
            <th data-tip="MAC‑адрес источника (уровень L2)">Src MAC</th>
            <th data-tip="MAC‑адрес получателя (уровень L2)">Dst MAC</th>
            <th data-tip="IP‑адрес источника (уровень L3)">Src</th>
            <th data-tip="IP‑адрес получателя (уровень L3)">Dst</th>
            <th data-tip="Владелец публичного IP (Орг/ASN/Страна)">Владелец</th>
            <th data-tip="Краткая сводка протокола. TCP/UDP показывают порты; ICMP/ARP — служебные">Протокол</th>
            <th data-tip="Общий размер пакета в байтах">Длина</th>
          </tr>
        </thead>
        <tbody id="log-body"></tbody>
      </table>
    </section>
  </main>
</body>
</html>
